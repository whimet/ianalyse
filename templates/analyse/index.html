{% extends "analyse/layout.html" %}

{% block title %}ianalyse - Take a closer look at your project{% endblock %}

{% block extrahead %}
<script type="text/javascript" src="{{ MEDIA_URL }}/js/swfobject.js"></script>
<link href="{{ MEDIA_URL }}/css/dashboard.css" media="screen" rel="stylesheet" type="text/css"/>
{% endblock %}
{% block content %}
{% load builds_tag %}

{% group_cmp MEDIA_URL configs group_id %}
<div style="margin-left:500px;margin-top:0.5em;margin-bottom:0.5em">
	<input id="export" type="button" value="Export as Image"></input>
	Group {%group_selection groups group_id %}
</div>
<script>
$(document).ready(function(){
	$("#group_selection_box").change(function(e){
		var selected = $("#group_selection_box option:selected");   
		window.location = '/analyse/index.html?groups=' + selected.text()
	});	     
	});
</script>
<b id="projects_comparation"></b>
<script>
function findSWF(movieName) {
	if (navigator.appName.indexOf("Microsoft")!= -1) {
		return window[movieName];
	} else {
		return document[movieName];
	}
}

$(function() {
	$('#export').click(function(){
		var chartObj = $("#projects_comparation").get(0);
		$.ajax({
		    type: "POST",
		    url: '/analyse/export.html?file=projects_comparation.png',
		    contentType: 'application/octet-stream',
		    processData: false,
		    data: 'data=' + chartObj.get_img_binary(),
		    dataType: "text",
		    success: function(data) {
				$('#light_box').lightBox();
				$('#light_box').click()
				$('#lightbox-container-image-box').html(data)
		    }
		});
	})
});
</script>

<div id="preview_container">
	<ul class="previews">
		{% for item in configs.items %}
			<li class="preview">
				{% if item.1.has_result %}
				  	<b id="total_pass_rate_{{item.0}}"></b>				
					<script type="text/javascript">
					    swfobject.embedSWF(
					            "{{ MEDIA_URL }}/swf/open-flash-chart.swf", "total_pass_rate_{{item.0}}", "120", "120",
					            "9.0.0", "expressInstall.swf",
					    {"data-file":"/results/{{item.0}}/overall_pass_rate.txt"}
					            );
					</script>

				{% else %}
					<span class="miss_data">
						Missing Data 
						<a href="/analyse/setup.html?id={{item.0}}">Reslove it NOW!</a>
					</span>
				{% endif %}
				<div>
					{% more_attention_icon project_groups item.0 %}
					{% build_status_icon project_groups item.0 %}
				</div>
				<a class="name " href="/analyse/show.html?id={{item.0}}">{{item.0}}</a>
			</li>
		{% endfor %}
	</ul>
</div>
<div id="light_box" style="display:none"></div>
{% endblock %}